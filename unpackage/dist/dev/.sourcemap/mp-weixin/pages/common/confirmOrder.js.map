{"version":3,"sources":["uni-app:///main.js","webpack:///E:/和鞋一号/pages/common/confirmOrder.vue?944e","webpack:///E:/和鞋一号/pages/common/confirmOrder.vue?903d","webpack:///E:/和鞋一号/pages/common/confirmOrder.vue?92bd","webpack:///E:/和鞋一号/pages/common/confirmOrder.vue?c533","uni-app:///pages/common/confirmOrder.vue"],"names":["createPage","Page"],"mappings":"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","file":"pages/common/confirmOrder.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/common/confirmOrder.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./confirmOrder.vue?vue&type=template&id=2cb85e29&\"\nvar renderjs\nimport script from \"./confirmOrder.vue?vue&type=script&lang=js&\"\nexport * from \"./confirmOrder.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/common/confirmOrder.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./confirmOrder.vue?vue&type=template&id=2cb85e29&\"","var components = {\n  headerTop: function() {\n    return import(\n      /* webpackChunkName: \"components/headerTop/headerTop\" */ \"@/components/headerTop/headerTop.vue\"\n    )\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./confirmOrder.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX.2.9.3.20201014.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./confirmOrder.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"flex_colT flex_items_stretch bg_f2f2f2 \" :class=\"show ? '' : 'H_100vh'\">\r\n\t\t<headerTop title=\"【和鞋一号】严选商城\"></headerTop>\r\n\t\t<view class=\"bg_ff5126 P_2 relative flex_rowC color_fff fontS_16\">\r\n\t\t\t<view class=\"iconfont absolute PL_2\" style=\"left: 0;\" @click=\"goBack\">&#xe724;</view>\r\n\t\t\t<view>确认订单</view>\r\n\t\t</view>\r\n\t\t<view class=\"PLR_2\">\r\n\t\t\t<view class=\"flex_rowC\">\r\n\t\t\t\t<view v-if=\"!address.id\" class=\"MTB_2 bg_fff W_100 PTB_4 PLR_2 flex_row_between B_radius_15\" @click=\"$openPage({name:'shopSelectAddress'})\">\r\n\t\t\t\t\t<view class=\"\">\r\n\t\t\t\t\t\t暂无收货地址，请添加收货地址\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"iconfont\">\r\n\t\t\t\t\t\t&#xe600;\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view v-else class=\"MTB_2 bg_fff W_100 PTB_4 PLR_2 flex_row_between B_radius_15\" @click=\"$openPage({name:'shopSelectAddress',query:{aid:address.id}})\">\r\n\t\t\t\t\t<view class=\"flex_rowL\">\r\n\t\t\t\t\t\t<image src=\"http://qnyimages.hexieyihao.vip/address.png\" class=\"WH_10vw B_radius_max ML_1 MR_3\" mode=\"\"></image>\r\n\t\t\t\t\t\t<view class=\"\">\r\n\t\t\t\t\t\t\t<view class=\"flex_rowL PB_2\">\r\n\t\t\t\t\t\t\t\t<view class=\"fontS_16 font_weight_bold\">{{address.username}}</view>\r\n\t\t\t\t\t\t\t\t<view class=\"color_999 ML_3\">{{address.mobile}}</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"color_999\" v-if=\"address.province\">{{address.province}}{{address.city}}{{address.country}}{{address.detail}}</view>\r\n\t\t\t\t\t\t\t<view class=\"color_999\" v-else>{{address.address}}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"WH_8vw flex_colC\">\r\n\t\t\t\t\t\t<view class=\"iconfont color_FFC41C\">\r\n\t\t\t\t\t\t\t&#xe600;\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"bg_fff B_radius_15 PTB_3 PLR_2\" v-if=\"show\">\r\n\t\t\t\t<view class=\"PB_2\" v-for=\"(item,index) in order.goods_list\" :key=\"index\">\r\n\t\t\t\t\t<view class=\"flex_row_between\">\r\n\t\t\t\t\t\t<view class=\"MR_2 flex_colC\">\r\n\t\t\t\t\t\t\t<image class=\"WH_26vw B_radius_10\" :src=\"item.img\" mode=\"\"></image>\r\n\t\t\t\t\t\t\t<view class=\"PTB_1\">\r\n\t\t\t\t\t\t\t\t<!-- ￥{{item.goods_price}} -->\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"W_65 fontS_12\">\r\n\t\t\t\t\t\t\t<view class=\"flex_row_between\">\r\n\t\t\t\t\t\t\t\t<view class=\"text_overflow_1 \">{{item.goods_name}}</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"PTB_1 color_ED2251 fontS_12 flex_row_between\">\r\n\t\t\t\t\t\t\t\t<view>￥{{item.goods_price}}</view>\r\n\t\t\t\t\t\t\t\t<view v-if=\"item.total_zms > 0\">购买省:{{item.total_zms}}</view>\r\n\t\t\t\t\t\t\t\t<view>{{item.total_goods_nums}}</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"B_1_bbb bg_f2f2f2 P_1 H_12vw overflow_y\">\r\n\t\t\t\t\t\t\t\t<view class=\" PT_1 PR_2\" v-for=\"(asset,idx) in item.attr_list\" :key=\"idx\">\r\n\t\t\t\t\t\t\t\t\t{{asset}}\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"flex_rowL PT_2\">\r\n\t\t\t\t\t\t\t\t<view>配送方式:</view>\r\n\t\t\t\t\t\t\t\t<view class=\"color_999 PL_1\">{{item.post_info.post_text}}</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"PLR_2\">\r\n\t\t\t\t\t<view class=\"flex_rowR PTB_2 color_ED2251\" v-if=\"order.total_zms_money > 0\">\r\n\t\t\t\t\t\t<view>购买省</view>\r\n\t\t\t\t\t\t<view class=\"\">￥{{order.total_zms_money}}</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"flex_row_between PTB_2\">\r\n\t\t\t\t\t\t<view>运费 {{order.post_money}}</view>\r\n\t\t\t\t\t\t<view class=\"iconfont\">&#xe600;</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\r\n\t\t\t\t<view class=\"flex_rowR PTB_2 BB_1_f2f2f2\">\r\n\t\t\t\t\t<view class=\"fontS_12\">共{{order.total_goos_nums}}件,实付：</view>\r\n\t\t\t\t\t<view class=\"color_ED2251 fontS_18\">\r\n\t\t\t\t\t\t￥{{order.order_price}}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"PTB_2\">\r\n\t\t\t\t\t<van-cell-group>\r\n\t\t\t\t\t\t<van-field :value=\"remark\" label=\"备注\" @input=\"onInput\" type=\"textarea\" placeholder=\"请输入备注\" autosize :border=\"false\" />\r\n\t\t\t\t\t</van-cell-group>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"H_20vw\">\r\n\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"fixed H_14vw W_100 flex_row_between z_index_100\" style=\"bottom: 0;\" v-if=\"show\">\r\n\t\t\t<view class=\"PL_2 bg_fff flex_grow_1 H_100 flex_rowL\">\r\n\t\t\t\t<view class=\"fontS_16\">合计：</view>\r\n\t\t\t\t<view class=\"fontS_20 color_ED2251\">￥{{order.order_price}}</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"bg_ff5126 color_fff H_100 W_35 textC fontS_16\" style=\"line-height: 14vw;\" @click=\"creationOrder\">\r\n\t\t\t\t提交订单\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport headerTop from '../../components/headerTop/headerTop.vue';\r\n\timport api from '../../static/script/ajax.js';\r\n\timport {\r\n\t\tgetDefaultAddress,\r\n\t\tcreateOrder,\r\n\t\tgetPaySign,\r\n\t\tuserInfo,\r\n\t\tsaveArea,\r\n\t\tcheckOrder,\r\n\t\tcheckBindMobile\r\n\t} from '../../static/script/const.js';\r\n\timport {\r\n\t\tpay\r\n\t} from '../../static/script/minix.js'\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tshow: false,\r\n\t\t\t\torder: {},\r\n\t\t\t\taddress: {},\r\n\t\t\t\tremark: '',\r\n\t\t\t\tjson_str: '',\r\n\t\t\t\taddress_id: '',\r\n\t\t\t\ttype: '',\r\n\t\t\t\tremarkStr: ''\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\t// this.order = this.$parseURL().data;\r\n\t\t\tif (this.$parseURL().json_str) {\r\n\t\t\t\tthis.json_str = this.$parseURL().json_str;\r\n\t\t\t}\r\n\t\t\tif (this.$parseURL().car_ids) {\r\n\t\t\t\tthis.car_ids = this.$parseURL().car_ids;\r\n\t\t\t}\r\n\t\t\tthis.type = this.$parseURL().order_type;\r\n\t\t\tuni.$on('checkSite', (data) => {\r\n\t\t\t\tconsole.log(data);\r\n\t\t\t\tthis.address_id = data.site.id;\r\n\t\t\t\tthis.address = data.site;\r\n\t\t\t})\r\n\t\t\tthis.getAddress();\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\tthis.bindMobile();\r\n\t\t\tif (this.address_id) {\r\n\t\t\t\tthis.checkOrders();\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tbindMobile() {\r\n\t\t\t\tapi._post(checkBindMobile, {}).then((res) => {\r\n\t\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\t\tif (res.data.is_bind_mobile != 1) {\r\n\t\t\t\t\t\t\tthis.$openPage({\r\n\t\t\t\t\t\t\t\tname: 'bindMobile'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tgetAddress() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tapi._post(getDefaultAddress, {}).then((res) => {\r\n\t\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\t\tthat.address = res.data;\r\n\t\t\t\t\t\tif (res.data.id) {\r\n\t\t\t\t\t\t\tthat.address_id = res.data.id;\r\n\t\t\t\t\t\t\tthat.checkOrders();\r\n\t\t\t\t\t\t\tthat.show = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tcheckOrders() {\r\n\t\t\t\tlet param;\r\n\t\t\t\tif (this.type == 'cart') {\r\n\t\t\t\t\tparam = {\r\n\t\t\t\t\t\t'address_id': this.address_id,\r\n\t\t\t\t\t\t'json_str': '',\r\n\t\t\t\t\t\t'car_ids': this.car_ids\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparam = {\r\n\t\t\t\t\t\t'address_id': this.address_id,\r\n\t\t\t\t\t\t'json_str': this.json_str,\r\n\t\t\t\t\t\t'car_ids': ''\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tapi._post(checkOrder, param).then((res) => {\r\n\t\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\t\t// console.log(res.data)\r\n\t\t\t\t\t\tthis.order = res.data;\r\n\t\t\t\t\t\tthis.show = true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.msg,\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tcreationOrder() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tif (!that.address.id) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '您还未添加收货地址，请先添加收货地址',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tapi._post(userInfo, {}).then((res) => {\r\n\t\t\t\t\tconsole.log(res.data)\r\n\t\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\t\tif (res.data.info.is_area == 1) {\r\n\t\t\t\t\t\t\tthat.getPosition();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthat.creatBuyOrder();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.msg,\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tcreatBuyOrder() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\t'address_id': that.address.id,\r\n\t\t\t\t\t'remark': that.remarkStr,\r\n\t\t\t\t\t'json_str': that.json_str,\r\n\t\t\t\t\t'car_ids': that.car_ids\r\n\t\t\t\t}\r\n\t\t\t\tapi._post(createOrder, params).then((res) => {\r\n\t\t\t\t\t// console.log(res)\r\n\t\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\t\tapi._post(getPaySign, {\r\n\t\t\t\t\t\t\t'paySite': res.data.paySite,\r\n\t\t\t\t\t\t\t'payType': 'xiaochengxu',\r\n\t\t\t\t\t\t\t'payId': res.data.payId\r\n\t\t\t\t\t\t}).then((ret) => {\r\n\t\t\t\t\t\t\t// console.log(JSON.parse(ret.data.info.pay_sign_str));\r\n\t\t\t\t\t\t\tlet obj = JSON.parse(ret.data.info.pay_sign_str);\r\n\t\t\t\t\t\t\tpay(obj, 'goods')\r\n\t\t\t\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: res.msg,\r\n\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.msg,\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tgoBack() {\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdelta: 1\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tonInput(e) {\r\n\t\t\t\t// console.log(e.detail);\r\n\t\t\t\tthis.remarkStr = e.detail\r\n\t\t\t},\r\n\t\t\tgetPosition(){\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tuni.authorize({ // 发起请求用户授权\r\n\t\t\t\t\tscope: 'scope.userLocation',\r\n\t\t\t\t\tsuccess:(res) => { // 用户允许了授权\r\n\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\tuni.getLocation({ // 请求位置信息\r\n\t\t\t\t\t\t\ttype: 'wgs84',\r\n\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\tconsole.log(res, 95); //  得到位置信息（经纬度，速度等等\r\n\t\t\t\t\t\t\t\tlet param = {\r\n\t\t\t\t\t\t\t\t\t'lon': res.longitude,\r\n\t\t\t\t\t\t\t\t\t'lat': res.latitude\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tapi._post(saveArea, param).then((ass) => {\r\n\t\t\t\t\t\t\t\t\tif (ass.code == 0) {\r\n\t\t\t\t\t\t\t\t\t\tthat.creatBuyOrder();\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: res.msg,\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail:(err) => {\r\n\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\tuni.getSetting({\r\n\t\t\t\t\t\t\tsuccess(res) { // 查看所有权限\r\n\t\t\t\t\t\t\t\tconsole.log(res.authSetting['scope.userLocation']);\r\n\t\t\t\t\t\t\t\tlet status = res.authSetting['scope.userLocation'] // 查看位置权限的状态，此处为初次请求，所以值为undefined\r\n\t\t\t\t\t\t\t\tif (!status) { // 如果是首次授权(undefined)或者之前拒绝授权(false)\r\n\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '是否授权当前位置',\r\n\t\t\t\t\t\t\t\t\t\tcontent: '需要获取您的地理位置,请确认授权,否则会影响下单支付功能使用',\r\n\t\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.openSetting({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: (ret) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(ret.authSetting);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (ret.authSetting[\"scope.userLocation\"]) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthat.getPosition();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthat.getPosition();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomponents: {\r\n\t\t\theaderTop,\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\r\n\r\n</style>\r\n"],"sourceRoot":""}